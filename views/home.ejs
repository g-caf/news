<%- include('partials/head', { title: 'Latest Stories' }) %>
<body class="home-page">
    <%- include('partials/header') %>
    
    <main class="main-content">
        <div class="articles-grid">
            <% if (articles.length === 0) { %>
                <div class="no-articles-tile">
                    <div class="no-articles-content">
                        <h3>No articles found</h3>
                        <p>Try adjusting your filters</p>
                    </div>
                </div>
            <% } else { %>
                <% articles.forEach(article => { %>
                    <article class="article-card <%= article.image_url ? '' : 'no-image' %>" onclick="window.location='/articles/<%= article.id %>'">
                        <% if (article.image_url) { %>
                            <img src="<%= article.image_url %>" alt="<%= article.title %>" class="article-image" loading="lazy" onerror="this.parentElement.classList.add('no-image'); this.style.display='none';">
                        <% } %>
                        <div class="article-overlay">
                            <div class="article-meta">
                                <span class="publication-name"><%= article.publication_name %></span>
                                <span class="publish-date"><%= article.published_date ? new Date(article.published_date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' }) : 'Recent' %></span>
                            </div>
                            <h2 class="article-title">
                                <a href="/articles/<%= article.id %>"><%= article.title %></a>
                            </h2>
                        </div>
                    </article>
                <% }) %>
                
                <% if (articles.length >= 20) { %>
                    <div class="load-more-tile">
                        <% 
                        const params = new URLSearchParams();
                        params.set('offset', (offset || 0) + 20);
                        if (selectedPublication) params.set('publication', selectedPublication);
                        if (selectedCategory) params.set('category', selectedCategory);
                        if (selectedTag) params.set('tag', selectedTag);
                        %>
                        <a href="?<%= params.toString() %>" class="load-more-content">
                            <div class="load-more-text">Load More</div>
                        </a>
                    </div>
                <% } %>
            <% } %>
        </div>
    </main>
    
    <%- include('partials/footer') %>
